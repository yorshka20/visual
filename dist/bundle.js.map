{"version":3,"file":"bundle.js","sources":["../src/canvas/canvas.ts","../src/config/index.ts","../src/eventBus/EventBus.ts","../src/eventBus/EventTypes.ts","../src/eventBus/index.ts","../src/mesh/interface.ts","../src/mesh/utils.ts","../src/highlight/highlight.ts","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/isObject.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/_freeGlobal.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/_root.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/now.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/_trimmedEndIndex.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/_baseTrim.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/_Symbol.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/_getRawTag.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/_objectToString.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/_baseGetTag.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/isObjectLike.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/isSymbol.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/toNumber.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/debounce.js","../node_modules/.pnpm/registry.npmmirror.com+lodash@4.17.21/node_modules/lodash/throttle.js","../src/interaction/interaction.ts","../src/shape/utils.ts","../src/mesh/mesh.ts","../src/shape/shape.ts","../src/demo/utils.ts","../src/demo/demo.ts","../src/index.ts"],"sourcesContent":["/*\r\n * @Author: yorshka\r\n * @Date: 2021-01-29 22:43:14\r\n * @Last Modified by: yorshka\r\n * @Last Modified time: 2021-01-30 17:26:28\r\n *\r\n * 自定义canvas类型，大小与容器一致\r\n */\r\n\r\nimport { CanvasOptions } from './interface';\r\n\r\nexport default class Canvas {\r\n  // 挂载容器\r\n  protected container: HTMLElement | null;\r\n  // DOM canvas元素实例(对外暴露)\r\n  public canvasEle: HTMLCanvasElement | null;\r\n  // 2d context\r\n  public ctx: CanvasRenderingContext2D | null;\r\n\r\n  // 宽高\r\n  protected width: number;\r\n  protected height: number;\r\n\r\n  constructor(options: CanvasOptions) {\r\n    const { container, zIndex, hide, id } = options;\r\n\r\n    //   保存canvas挂载容器\r\n    this.container = container;\r\n\r\n    //   创建canvas元素\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = container.clientWidth;\r\n    canvas.height = container.clientHeight;\r\n\r\n    this.width = container.clientWidth;\r\n    this.height = container.clientHeight;\r\n\r\n    // 设置id\r\n    canvas.setAttribute('id', id);\r\n\r\n    //   set absolute position for multiple-layer canvas layout.\r\n    canvas.style.position = 'absolute';\r\n    canvas.style.top = '0';\r\n    canvas.style.left = '0';\r\n\r\n    // 设置z层级\r\n    canvas.style.zIndex = zIndex + '';\r\n\r\n    //   store canvas element\r\n    this.canvasEle = canvas;\r\n    this.ctx = canvas.getContext('2d');\r\n\r\n    // 设置层叠顺序\r\n    this.ctx.globalCompositeOperation = 'source-over';\r\n\r\n    // 初始化stroke样式(default)\r\n    this.ctx.lineWidth = 1;\r\n    this.ctx.strokeStyle = '#000';\r\n\r\n    //   mount canvas element\r\n    if (!hide) {\r\n      this.container!.appendChild(canvas);\r\n    }\r\n  }\r\n}\r\n","// mesh格子大小\r\nexport const GRIDSIZE = 10;\r\n\r\n// 是否渲染网格\r\nexport const SHOW_MESH = true;\r\n\r\n// 是否渲染格点\r\nexport const SHOW_MESH_POINT = false;\r\n\r\n// 是否渲染shape cover的grid\r\nexport const SHOW_SHAPE_GRID = false;\r\n\r\n// 是否渲染高亮框\r\nexport const SHOW_HIGHLIGHT = true;\r\n\r\n// 点击变色色列\r\nexport const COLOR_SET = ['#FF0000', '#EE0000', '#CD0000', '#8B0000'];\r\n","/*\r\n * @Author: yorshka\r\n * @Date: 2021-01-19 16:24:29\r\n * @Last Modified by: yorshka\r\n * @Last Modified time: 2021-01-29 23:52:35\r\n *\r\n * EventBus 工具类\r\n * 需要从全局作用域iife重构为class，否则会导致无法追踪的匿名监听器残留\r\n */\r\n\r\ninterface Namespace {\r\n  on: (...args: any) => void;\r\n  remove: (...args: any) => void;\r\n  emit: (...args: any) => void;\r\n  eventBucket: NamespaceEventBucket;\r\n}\r\n\r\ninterface NamespaceEventBucket {\r\n  [eventName: string]: EventHandler[];\r\n}\r\n\r\ninterface EventHandler {\r\n  (...args: any): void;\r\n}\r\n\r\nexport default class EventBus {\r\n  private static _instance: EventBus;\r\n\r\n  static get instance(): EventBus {\r\n    if (!this._instance) {\r\n      this._instance = new EventBus();\r\n    }\r\n\r\n    return this._instance;\r\n  }\r\n\r\n  private defaultNamespace: string;\r\n\r\n  private namespaceCache: Map<string, Namespace>;\r\n\r\n  constructor() {\r\n    if (EventBus._instance) {\r\n      return EventBus._instance;\r\n    }\r\n\r\n    this.defaultNamespace = 'default';\r\n    this.namespaceCache = new Map<string, Namespace>();\r\n\r\n    EventBus._instance = this;\r\n  }\r\n\r\n  public clean(): void {\r\n    this.namespaceCache = null;\r\n\r\n    EventBus._instance = null;\r\n  }\r\n\r\n  public namespace(inputName: string): Namespace {\r\n    const name = inputName || this.defaultNamespace; // 命名空间\r\n\r\n    if (this.namespaceCache?.get(name)) {\r\n      return this.namespaceCache.get(name);\r\n    }\r\n\r\n    const namespace: Namespace = {\r\n      on: (key: string, fn: EventHandler) => {\r\n        this.on(name, key, fn);\r\n      },\r\n      remove: (key: string, fn: EventHandler) => {\r\n        this.remove(name, key, fn);\r\n      },\r\n      emit(...args: any) {\r\n        const [event, params] = args;\r\n        const eventHandlers = this.eventBucket?.[event];\r\n        if (eventHandlers?.length) {\r\n          eventHandlers.forEach((handler: EventHandler) => {\r\n            handler(params);\r\n          });\r\n        }\r\n      },\r\n      eventBucket: {}, // 闭包中的事件缓存\r\n    };\r\n\r\n    this.namespaceCache.set(name, namespace);\r\n\r\n    return namespace;\r\n  }\r\n\r\n  // 监听一个事件\r\n  private on = function (name: string, key: string, fn: EventHandler): void {\r\n    const namespace = this.namespaceCache?.get(name);\r\n    if (!namespace) {\r\n      return;\r\n    }\r\n\r\n    const cache = namespace.eventBucket;\r\n    if (!cache[key]) {\r\n      cache[key] = [];\r\n    }\r\n    cache[key].push(fn);\r\n  };\r\n\r\n  // 移除一个事件。如果fn为空，则清空该事件下的所有事件\r\n  private remove = function (\r\n    name: string,\r\n    key: string,\r\n    fn?: EventHandler\r\n  ): void {\r\n    const namespace = this.namespaceCache?.get(name);\r\n    if (!namespace) {\r\n      return;\r\n    }\r\n\r\n    const cache = namespace.eventBucket;\r\n    if (cache[key]) {\r\n      if (fn) {\r\n        for (let i = cache[key].length; i >= 0; i--) {\r\n          if (cache[key][i] === fn) {\r\n            cache[key].splice(i, 1);\r\n          }\r\n        }\r\n      } else {\r\n        cache[key] = [];\r\n      }\r\n    }\r\n  };\r\n}\r\n","/**\r\n * 消息类型\r\n */\r\nexport enum EventTypes {\r\n  MOVE = 'move',\r\n  MOUSEDOWN = 'mousedown',\r\n\r\n  HOVER = 'hover',\r\n  CLICK = 'click',\r\n\r\n  SHAPE = 'shape',\r\n}\r\n\r\n/**\r\n * 消息命名空间\r\n */\r\nexport enum Namespace {\r\n  INTERACTION = 'interaction',\r\n  INIT = 'init',\r\n}\r\n","import EventBus from './EventBus';\r\nimport { EventTypes, Namespace } from './EventTypes';\r\n\r\nconst bus = new EventBus();\r\n\r\nexport { bus as EventBus, EventTypes, Namespace };\r\n","/*\r\n * @Author: yorshka\r\n * @Date: 2021-01-29 22:35:02\r\n * @Last Modified by: yorshka\r\n * @Last Modified time: 2021-01-30 18:56:51\r\n */\r\n\r\nimport { CanvasOptions } from '@src/canvas/interface';\r\n\r\nexport interface MeshOptions extends CanvasOptions {\r\n  gridSize: number;\r\n}\r\n\r\nexport interface BoundingBoxData {\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\n// 包围盒\r\nexport class BoundingBox {\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n\r\n  constructor(data: BoundingBoxData) {\r\n    const { x, y, width, height } = data;\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = width;\r\n    this.height = height;\r\n  }\r\n}\r\n\r\nexport interface GridCacheList {\r\n  topIndex: number;\r\n  list: string[];\r\n}\r\n\r\nexport interface Point {\r\n  x: number;\r\n  y: number;\r\n}\r\n","/*\r\n * @Author: yorshka\r\n * @Date: 2021-01-30 13:13:02\r\n * @Last Modified by: yorshka\r\n * @Last Modified time: 2021-01-31 14:56:49\r\n */\r\n\r\nimport { Shape } from '@src/shape';\r\nimport { BoundingBox } from './interface';\r\n\r\n// 返回一个矩形\r\nexport function computeBoundingBox(shape: Shape): BoundingBox {\r\n  return new BoundingBox({\r\n    x: shape.x - shape.radius,\r\n    y: shape.y - shape.radius,\r\n    width: 2 * shape.radius,\r\n    height: 2 * shape.radius,\r\n  });\r\n}\r\n\r\n// 两点之间距离\r\nexport function getDistance(\r\n  x1: number,\r\n  y1: number,\r\n  x2: number,\r\n  y2: number\r\n): number {\r\n  return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\r\n}\r\n","/*\r\n * @Author: yorshka\r\n * @Date: 2021-01-30 17:18:10\r\n * @Last Modified by: yorshka\r\n * @Last Modified time: 2021-01-30 20:31:48\r\n *\r\n * 高亮层，绘制鼠标感知状态\r\n */\r\n\r\nimport { Canvas } from '@src/canvas';\r\nimport { CanvasOptions } from '@src/canvas/interface';\r\nimport { EventBus, EventTypes, Namespace } from '@src/eventBus';\r\nimport { computeBoundingBox } from '@src/mesh/utils';\r\nimport { Shape } from '@src/shape';\r\n\r\ninterface HighlightOptions extends CanvasOptions {\r\n  //\r\n}\r\n\r\nexport default class Highlight extends Canvas {\r\n  private _target: Shape; // hover shape id\r\n\r\n  private get hoverTarget() {\r\n    return this._target;\r\n  }\r\n\r\n  private set hoverTarget(val: Shape) {\r\n    if (!val) {\r\n      this.clean();\r\n      return;\r\n    }\r\n\r\n    if (val.id !== this._target?.id || !this._target) {\r\n      this._target = val;\r\n      this.clean();\r\n      this.drawHighlight(val);\r\n    }\r\n  }\r\n\r\n  constructor(options: HighlightOptions) {\r\n    super(options);\r\n\r\n    //   设置高亮stroke颜色\r\n    this.ctx.strokeStyle = '#00FF00';\r\n\r\n    this._target = null;\r\n\r\n    //   初始化监听器\r\n    this.init();\r\n  }\r\n\r\n  public destroy(): void {\r\n    this.uninit();\r\n  }\r\n\r\n  private init(): void {\r\n    EventBus.namespace(Namespace.INTERACTION).on(\r\n      EventTypes.HOVER,\r\n      this.hoverHandler\r\n    );\r\n  }\r\n\r\n  private uninit(): void {\r\n    EventBus.namespace(Namespace.INTERACTION).remove(EventTypes.HOVER);\r\n  }\r\n\r\n  private hoverHandler = (shape: Shape) => {\r\n    this.hoverTarget = shape;\r\n  };\r\n\r\n  // 绘制高亮框\r\n  private drawHighlight(shape: Shape): void {\r\n    const rect = computeBoundingBox(shape);\r\n\r\n    this.ctx.strokeRect(rect.x, rect.y, rect.width, rect.height);\r\n  }\r\n\r\n  private clean(): void {\r\n    this.ctx.clearRect(0, 0, this.width, this.height);\r\n  }\r\n}\r\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nmodule.exports = trimmedEndIndex;\n","var trimmedEndIndex = require('./_trimmedEndIndex');\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nmodule.exports = baseTrim;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var baseTrim = require('./_baseTrim'),\n    isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","var debounce = require('./debounce'),\n    isObject = require('./isObject');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nmodule.exports = throttle;\n","/*\r\n * @Author: yorshka\r\n * @Date: 2021-01-29 23:38:02\r\n * @Last Modified by: yorshka\r\n * @Last Modified time: 2021-01-30 20:52:58\r\n *\r\n * 交互感知层\r\n */\r\n\r\nimport { Canvas } from '@src/canvas';\r\nimport { EventBus, EventTypes, Namespace } from '@src/eventBus';\r\nimport { Mesh } from '@src/mesh';\r\nimport throttle from 'lodash/throttle';\r\n\r\ninterface InteractionOptions {\r\n  target: Canvas;\r\n}\r\n\r\nexport default class Interaction {\r\n  // 监听目标元素\r\n  private target: HTMLCanvasElement;\r\n\r\n  constructor(options: InteractionOptions) {\r\n    this.target = options.target.canvasEle;\r\n\r\n    this.init();\r\n  }\r\n\r\n  // 销毁\r\n  public destroy(): void {\r\n    this.target.removeEventListener('mousedown', this.mouseDownHandler);\r\n    this.target.removeEventListener('mousemove', this.mouseMoveHandler);\r\n  }\r\n\r\n  // 挂载监听器\r\n  public init(): void {\r\n    this.target.addEventListener('mousedown', this.mouseDownHandler);\r\n    this.target.addEventListener('mousemove', this.mouseMoveHandler);\r\n  }\r\n\r\n  private mouseMoveHandler = (e: MouseEvent) =>\r\n    throttle((e: MouseEvent) => {\r\n      const { offsetX, offsetY } = e;\r\n      // 发送事件\r\n      EventBus.namespace(Namespace.INTERACTION).emit(EventTypes.MOVE, {\r\n        x: offsetX,\r\n        y: offsetY,\r\n      });\r\n    }, 20)(e);\r\n\r\n  private mouseDownHandler = (e: MouseEvent) => {\r\n    const { offsetX, offsetY } = e;\r\n    // 发送事件\r\n    EventBus.namespace(Namespace.INTERACTION).emit(EventTypes.MOUSEDOWN, {\r\n      x: offsetX,\r\n      y: offsetY,\r\n    });\r\n  };\r\n}\r\n","/*\r\n * @Author: yorshka\r\n * @Date: 2021-01-30 15:08:51\r\n * @Last Modified by: yorshka\r\n * @Last Modified time: 2021-01-30 22:00:05\r\n */\r\n\r\nimport { CoverArea } from '.';\r\n\r\n// 获得shape cover的格子\r\nexport function getCoveredGrid(\r\n  x: number,\r\n  y: number,\r\n  radius: number,\r\n  gridSize: number\r\n): string[] {\r\n  const list = [];\r\n\r\n  // boundingBox三顶点： 左上，右上，左下\r\n  const lt = [x - radius < 0 ? 0 : x - radius, y - radius < 0 ? 0 : y - radius];\r\n  const rt = [x + radius, y - radius < 0 ? 0 : y - radius];\r\n  const lb = [x - radius < 0 ? 0 : x - radius, y + radius];\r\n\r\n  // console.log('x,y,radius', x, y, radius);\r\n  // console.log('lt,rt,lb', lt, rt, lb);\r\n\r\n  const xAxis = [Math.floor(lt[0] / gridSize), Math.floor(rt[0] / gridSize)];\r\n  const yAxis = [Math.floor(lt[1] / gridSize), Math.floor(lb[1] / gridSize)];\r\n\r\n  // console.log('xAxis,yAxis', xAxis, yAxis);\r\n\r\n  for (let x = xAxis[0]; x <= xAxis[1]; x++) {\r\n    for (let y = yAxis[0]; y <= yAxis[1]; y++) {\r\n      list.push(`${x}:${y}`);\r\n    }\r\n  }\r\n\r\n  // console.log('list', list);\r\n\r\n  return list;\r\n}\r\n\r\n// 获取point在mesh中最近的grid位置\r\nexport function getMeshGrid(x: number, y: number, gridSize: number): number[] {\r\n  const gx = Math.floor(x / gridSize);\r\n  const gy = Math.floor(y / gridSize);\r\n\r\n  return [gx, gy];\r\n}\r\n\r\n// 计算cover区域\r\nexport function getCoverArea(\r\n  x: number,\r\n  y: number,\r\n  radius: number,\r\n  gridSize: number\r\n): CoverArea {\r\n  const area: CoverArea = {\r\n    x: 0,\r\n    y: 0,\r\n    width: 0,\r\n    height: 0,\r\n  };\r\n\r\n  // boundingBox三顶点： 左上，右上，左下\r\n  const lt = [x - radius < 0 ? 0 : x - radius, y - radius < 0 ? 0 : y - radius];\r\n  const rt = [x + radius, y - radius < 0 ? 0 : y - radius];\r\n  const lb = [x - radius < 0 ? 0 : x - radius, y + radius];\r\n\r\n  const xAxis = [Math.floor(lt[0] / gridSize), Math.floor(rt[0] / gridSize)];\r\n  const yAxis = [Math.floor(lt[1] / gridSize), Math.floor(lb[1] / gridSize)];\r\n\r\n  area.x = xAxis[0] * gridSize;\r\n  area.y = yAxis[0] * gridSize;\r\n  area.width = xAxis[1] * gridSize + gridSize - area.x;\r\n  area.height = yAxis[1] * gridSize + gridSize - area.y;\r\n\r\n  return area;\r\n}\r\n","/*\r\n * @Author: yorshka\r\n * @Date: 2021-01-29 22:34:19\r\n * @Last Modified by: yorshka\r\n * @Last Modified time: 2021-01-31 16:08:25\r\n *\r\n * mesh实例，用来作为网格坐标层\r\n */\r\n\r\nimport { Canvas } from '@src/canvas';\r\nimport { SHOW_MESH_POINT, SHOW_SHAPE_GRID } from '@src/config';\r\nimport { EventBus, EventTypes, Namespace } from '@src/eventBus';\r\nimport { Shape } from '@src/shape';\r\nimport { getMeshGrid } from '@src/shape/utils';\r\nimport { MeshOptions, GridCacheList, Point } from './interface';\r\nimport { getDistance } from './utils';\r\n\r\nexport default class Mesh extends Canvas {\r\n  static instance: Mesh;\r\n\r\n  // 缓冲数据集\r\n  shapeBucket: Map<string, Shape>;\r\n\r\n  // 格点缓存，以gridId为key，记录cover该grid的shape的list，shape按zindex倒序排\r\n  gridCache: Map<string, GridCacheList>;\r\n\r\n  // mesh网格格子大小\r\n  gridSize: number;\r\n\r\n  constructor(options: MeshOptions) {\r\n    super(options);\r\n\r\n    if (Mesh.instance) {\r\n      return Mesh.instance;\r\n    }\r\n\r\n    // 初始化缓存\r\n    this.shapeBucket = new Map<string, any>();\r\n    this.gridCache = new Map<string, GridCacheList>();\r\n\r\n    // 记录格点大小\r\n    this.gridSize = options.gridSize;\r\n\r\n    // 初始化监听器\r\n    this.initListener();\r\n\r\n    Mesh.instance = this;\r\n  }\r\n\r\n  public destroy(): void {\r\n    EventBus.namespace(Namespace.INTERACTION).remove(EventTypes.MOVE);\r\n    EventBus.namespace(Namespace.INIT).remove(EventTypes.SHAPE);\r\n    EventBus.namespace(Namespace.INTERACTION).remove(EventTypes.MOUSEDOWN);\r\n  }\r\n\r\n  private initListener(): void {\r\n    // shape初始化事件\r\n    EventBus.namespace(Namespace.INIT).on(\r\n      EventTypes.SHAPE,\r\n      this.handleShapeReady\r\n    );\r\n\r\n    // 鼠标移动事件\r\n    EventBus.namespace(Namespace.INTERACTION).on(\r\n      EventTypes.MOVE,\r\n      this.handleMouseMove\r\n    );\r\n\r\n    // 鼠标点击事件\r\n    EventBus.namespace(Namespace.INTERACTION).on(\r\n      EventTypes.MOUSEDOWN,\r\n      this.handleMouseDown\r\n    );\r\n  }\r\n\r\n  // 监听鼠标移动，计算当前hover shape\r\n  private handleMouseMove = (point: Point) => {\r\n    const grid = getMeshGrid(point.x, point.y, this.gridSize).join(':');\r\n    const cache = this.gridCache.get(grid);\r\n    if (cache) {\r\n      if (cache?.list?.length) {\r\n        const shape = this.shapeBucket.get(cache.list[0]);\r\n        EventBus.namespace(Namespace.INTERACTION).emit(EventTypes.HOVER, shape);\r\n        return;\r\n      }\r\n    }\r\n\r\n    EventBus.namespace(Namespace.INTERACTION).emit(EventTypes.HOVER, null);\r\n  };\r\n\r\n  // 鼠标点击\r\n  private handleMouseDown = (point: Point) => {\r\n    const grid = getMeshGrid(point.x, point.y, this.gridSize).join(':');\r\n    // console.log('grid', grid);\r\n    const cache = this.gridCache.get(grid);\r\n    if (cache) {\r\n      if (cache?.list?.length) {\r\n        // 此处可精细化处理：\r\n        // 1. 缩小搜索范围，将list中shape重新按照zindex排序\r\n        const shapeList = cache.list.map((i) => this.shapeBucket.get(i));\r\n        shapeList.sort((a, b) => b.zIndex - a.zIndex);\r\n\r\n        // 2. 精确计算被点击元素\r\n        const len = shapeList.length;\r\n        let target = shapeList[0];\r\n        for (let i = 0; i < len; i++) {\r\n          const shape = shapeList[i];\r\n          const radius = getDistance(point.x, point.y, shape.x, shape.y);\r\n          if (radius <= shape.radius) {\r\n            target = shape;\r\n            break;\r\n          }\r\n        }\r\n\r\n        target.zIndex = shapeList[0].zIndex + 1;\r\n\r\n        // 直接修改，不好吗？\r\n        this.gridCache.get(grid).list = shapeList.map((i) => i.id);\r\n\r\n        EventBus.namespace(Namespace.INTERACTION).emit(\r\n          EventTypes.CLICK,\r\n          target\r\n        );\r\n        return;\r\n      }\r\n    }\r\n  };\r\n\r\n  private handleShapeReady = (shape: Shape) => {\r\n    console.log('shape ready', shape);\r\n    this.recordShape(shape);\r\n  };\r\n\r\n  // 录入图形，形成坐标\r\n  public recordShape(shape: Shape): void {\r\n    const { id } = shape;\r\n\r\n    // 记录原始数据\r\n    this.shapeBucket.set(id, shape);\r\n\r\n    // 更新格点缓存\r\n    this.updateGridCache(shape);\r\n  }\r\n\r\n  // 删除图形\r\n  // TODO: 优化性能\r\n  public removeShape(shape: Shape): void {\r\n    const { id, meshGridList, zIndex } = shape;\r\n    this.shapeBucket.delete(id);\r\n\r\n    meshGridList.forEach((grid) => {\r\n      const cache = this.gridCache.get(grid);\r\n      if (cache) {\r\n        cache.list = cache.list.filter((i) => i != id);\r\n        if (cache.topIndex == zIndex && cache.list.length) {\r\n          const topShape = this.shapeBucket.get(cache.list[0]);\r\n          cache.topIndex = topShape.zIndex;\r\n        }\r\n\r\n        this.gridCache.set(grid, cache);\r\n      }\r\n    });\r\n  }\r\n\r\n  // 格点缓存\r\n  // 此处并未实现真实的zindex倒序排列，因此最终效果有偏差\r\n  private updateGridCache(shape: Shape): void {\r\n    const { id, meshGridList, zIndex } = shape;\r\n    meshGridList.forEach((grid) => {\r\n      let cache = this.gridCache.get(grid);\r\n      if (!cache) {\r\n        cache = {\r\n          list: [],\r\n          topIndex: 0,\r\n        };\r\n      }\r\n      let { topIndex, list } = cache;\r\n      // 更新最大zindex\r\n      if (zIndex > topIndex) {\r\n        topIndex = zIndex;\r\n        list.unshift(id);\r\n      } else {\r\n        list.push(id);\r\n      }\r\n\r\n      // 更新缓存\r\n      this.gridCache.set(grid, { topIndex, list });\r\n\r\n      if (SHOW_SHAPE_GRID) {\r\n        // debug\r\n        this.fillGrid(grid);\r\n      }\r\n    });\r\n  }\r\n\r\n  // 辅助方法：渲染格子\r\n  private fillGrid(grid: string) {\r\n    const [x, y] = grid.split(':').map((i) => Number(i));\r\n    this.ctx.fillStyle = '#666';\r\n    this.ctx.fillRect(\r\n      x * this.gridSize,\r\n      y * this.gridSize,\r\n      this.gridSize,\r\n      this.gridSize\r\n    );\r\n  }\r\n\r\n  // 渲染网格坐标\r\n  public renderGrid(): void {\r\n    const ctx = this.ctx;\r\n\r\n    ctx.lineWidth = 0.5;\r\n    ctx.strokeStyle = '#d2e2f7';\r\n\r\n    const gridSize = this.gridSize;\r\n\r\n    const xStart = 0;\r\n    const xEnd = this.container.clientWidth;\r\n    const yStart = 0;\r\n    const yEnd = this.container.clientHeight;\r\n\r\n    ctx.beginPath();\r\n\r\n    // 画网格, x axios\r\n    for (let x = xStart; x <= xEnd + gridSize; x += gridSize) {\r\n      // 超出坐标系绘制，防止有空隙\r\n      ctx.moveTo(x, yStart - gridSize);\r\n      ctx.lineTo(x, yEnd + gridSize);\r\n    }\r\n    // 画网格, y axios\r\n    for (let y = yStart; y <= yEnd + gridSize; y += gridSize) {\r\n      // 超出坐标系绘制，防止有空隙\r\n      ctx.moveTo(xStart - gridSize, y);\r\n      ctx.lineTo(xEnd + gridSize, y);\r\n    }\r\n\r\n    const xOffset = 0;\r\n    const yOffset = 0;\r\n\r\n    if (SHOW_MESH_POINT) {\r\n      // 画格线交点\r\n      for (let x = xStart - gridSize; x <= xEnd; x += gridSize) {\r\n        for (let y = yStart - gridSize; y <= yEnd; y += gridSize) {\r\n          if (\r\n            Math.abs(x + xOffset) % 100 == 0 &&\r\n            Math.abs(y + yOffset) % 100 == 0\r\n          ) {\r\n            ctx.strokeStyle = '#000';\r\n            ctx.strokeText(\r\n              `(${(x + xOffset) / gridSize},${(y + yOffset) / gridSize})`,\r\n              x + 1,\r\n              y - 1\r\n            );\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    ctx.closePath();\r\n\r\n    ctx.stroke();\r\n  }\r\n}\r\n","/*\r\n * @Author: yorshka\r\n * @Date: 2021-01-29 23:04:21\r\n * @Last Modified by: yorshka\r\n * @Last Modified time: 2021-01-31 13:28:16\r\n *\r\n * shape类型，用来储存需要被绘制的数据\r\n */\r\n\r\nimport { EventBus, EventTypes, Namespace } from '@src/eventBus';\r\nimport { Mesh } from '@src/mesh';\r\nimport { getCoverArea, getCoveredGrid } from './utils';\r\nimport { ShapeOptions, CoverArea } from './interface';\r\nexport default class Shape {\r\n  // 唯一id\r\n  id: string;\r\n\r\n  // ellipse 类型参数\r\n  x: number;\r\n  y: number;\r\n  radius: number;\r\n\r\n  // 填充颜色\r\n  fillColor: string;\r\n\r\n  // cover到的grid的区域\r\n  coverArea: CoverArea;\r\n\r\n  // 格点大小\r\n  gridSize: number;\r\n\r\n  // 层级参数\r\n  zIndex: number;\r\n\r\n  // 自身格点缓存信息\r\n  meshGridList: string[];\r\n\r\n  constructor(options: ShapeOptions) {\r\n    const { x, y, radius, zIndex } = options;\r\n\r\n    //   保存原始数据\r\n    this.x = x;\r\n    this.y = y;\r\n    this.radius = radius;\r\n    this.zIndex = zIndex;\r\n    this.coverArea = {\r\n      x: 0,\r\n      y: 0,\r\n      width: 0,\r\n      height: 0,\r\n    };\r\n\r\n    this.fillColor = '#00BFFF';\r\n\r\n    //   生成随机id\r\n    this.id = Math.random().toString(36).substring(2);\r\n\r\n    // shape晚于mesh实例化，所以此时mesh必定已经实例化完成\r\n    this.gridSize = Mesh.instance.gridSize;\r\n\r\n    // 初始化缓存\r\n    this.initCache();\r\n  }\r\n\r\n  // 初始化缓存\r\n  // 1. 找出所有覆盖到的grid\r\n  // 2. 记录每个grid的id\r\n  private initCache() {\r\n    setTimeout(() => {\r\n      const gridList = getCoveredGrid(\r\n        this.x,\r\n        this.y,\r\n        this.radius,\r\n        this.gridSize\r\n      );\r\n\r\n      // 记录cover区域，用于局部擦除\r\n      this.coverArea = getCoverArea(this.x, this.y, this.radius, this.gridSize);\r\n\r\n      this.meshGridList = gridList;\r\n      console.log('finish cache: ', this.zIndex, this.id);\r\n      EventBus.namespace(Namespace.INIT).emit(EventTypes.SHAPE, this);\r\n    }, 0);\r\n  }\r\n\r\n  public setColor(color: string): void {\r\n    this.fillColor = color;\r\n  }\r\n\r\n  public levelUp(): void {\r\n    this.zIndex += 1;\r\n  }\r\n\r\n  // 自身渲染\r\n  public render(ctx: CanvasRenderingContext2D): void {\r\n    if (!ctx) {\r\n      return;\r\n    }\r\n\r\n    // 描边\r\n    ctx.beginPath();\r\n    ctx.arc(this.x, this.y, this.radius, 0, 2 * Math.PI);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n\r\n    // 填充\r\n    ctx.beginPath();\r\n    ctx.arc(this.x, this.y, this.radius, 0, 2 * Math.PI);\r\n    ctx.fillStyle = this.fillColor;\r\n    ctx.fill();\r\n    ctx.closePath();\r\n  }\r\n}\r\n","/*\r\n * @Author: yorshka\r\n * @Date: 2021-01-30 20:58:08\r\n * @Last Modified by: yorshka\r\n * @Last Modified time: 2021-01-30 21:00:28\r\n */\r\n\r\nimport { COLOR_SET } from '@src/config';\r\n\r\nexport function getNextColor(color: string): string {\r\n  const index = COLOR_SET.indexOf(color);\r\n  if (index >= 0) {\r\n    if (index + 1 < COLOR_SET.length) {\r\n      return COLOR_SET[index + 1];\r\n    }\r\n  }\r\n\r\n  return COLOR_SET[0];\r\n}\r\n","/*\r\n * @Author: yorshka\r\n * @Date: 2021-01-29 10:25:35\r\n * @Last Modified by: yorshka\r\n * @Last Modified time: 2021-02-01 11:41:44\r\n *\r\n * canvas demo.\r\n *\r\n */\r\n\r\nimport { Canvas } from '@src/canvas';\r\nimport { GRIDSIZE, SHOW_HIGHLIGHT, SHOW_MESH } from '@src/config';\r\nimport { EventBus, EventTypes, Namespace } from '@src/eventBus';\r\nimport { Highlight } from '@src/highlight';\r\nimport { Interaction } from '@src/interaction';\r\nimport { Mesh } from '@src/mesh';\r\nimport { CoverArea, Shape } from '@src/shape';\r\nimport { DemoOptions } from './interface';\r\nimport { getNextColor } from './utils';\r\n\r\nexport default class Demo {\r\n  // 容器及实例\r\n  private container: HTMLElement | null;\r\n\r\n  private width: number;\r\n  private height: number;\r\n\r\n  // 粗粒化格子大小\r\n  private gridSize = GRIDSIZE;\r\n\r\n  // 交互控制句柄，可取消监听器\r\n  private interactionHandler: Interaction;\r\n\r\n  /* 按层级排列 */\r\n  // 鼠标事件感知层\r\n  private interactionLayer: Canvas;\r\n  // 缓存层\r\n  private cacheLayer: Canvas = null;\r\n  // 主画布\r\n  private displayLayer: Canvas;\r\n  // 坐标层\r\n  private meshLayer: Mesh;\r\n\r\n  constructor(options: DemoOptions) {\r\n    const { container: name } = options;\r\n\r\n    const container = document.getElementById(\r\n      name || 'container'\r\n    ) as HTMLElement;\r\n    // 保存容器\r\n    this.container = container;\r\n\r\n    this.width = container.clientWidth;\r\n    this.height = container.clientHeight;\r\n\r\n    // 鼠标动作感知图层\r\n    this.interactionLayer = new Canvas({\r\n      id: 'interaction',\r\n      container,\r\n      zIndex: 4,\r\n    });\r\n\r\n    // cache层，快速擦除，内容较少\r\n    if (SHOW_HIGHLIGHT) {\r\n      this.cacheLayer = new Highlight({\r\n        id: 'cache',\r\n        container,\r\n        zIndex: 3,\r\n      });\r\n    }\r\n\r\n    // 主画布\r\n    this.displayLayer = new Canvas({\r\n      id: 'main',\r\n      container,\r\n      zIndex: 2,\r\n    });\r\n\r\n    // 网格画布，用作坐标感知\r\n    this.meshLayer = new Mesh({\r\n      id: 'mesh',\r\n      container,\r\n      zIndex: 1,\r\n      // hide: true,\r\n      gridSize: this.gridSize,\r\n    });\r\n\r\n    // 渲染网格背景\r\n    if (SHOW_MESH) {\r\n      this.meshLayer.renderGrid();\r\n    }\r\n\r\n    // 交互handler\r\n    this.interactionHandler = new Interaction({\r\n      target: this.interactionLayer,\r\n    });\r\n\r\n    this.initListener();\r\n  }\r\n\r\n  public initListener(): void {\r\n    EventBus.namespace(Namespace.INTERACTION).on(\r\n      EventTypes.CLICK,\r\n      this.clickHandler\r\n    );\r\n    // EventBus.namespace(Namespace.INTERACTION).on(\r\n    //   EventTypes.MOVE,\r\n    //   this.moveHandler\r\n    // );\r\n    // EventBus.namespace(Namespace.INTERACTION).on(\r\n    //   EventTypes.HOVER,\r\n    //   this.hoverHandler\r\n    // );\r\n  }\r\n\r\n  public unbindEvent(): void {\r\n    EventBus.namespace(Namespace.INTERACTION).remove(EventTypes.CLICK);\r\n    // EventBus.namespace(Namespace.INTERACTION).remove(EventTypes.MOVE);\r\n    // EventBus.namespace(Namespace.INTERACTION).remove(EventTypes.HOVER);\r\n  }\r\n\r\n  // 点击元素\r\n  private clickHandler = (shape: Shape) => {\r\n    console.log('click', shape);\r\n    const { fillColor, meshGridList } = shape;\r\n    // 更新颜色\r\n    shape.setColor(getNextColor(fillColor));\r\n    // 更新位置\r\n    shape.levelUp();\r\n\r\n    // 1. 局部擦除\r\n    // 2. 按照zindex重绘被擦除的元素\r\n\r\n    // 建立局部刷新区域\r\n    // 待重绘shape\r\n    let reRenderShape: string[] = [];\r\n    // 记录待重绘元素\r\n    meshGridList.forEach((grid) => {\r\n      const cache = this.meshLayer.gridCache.get(grid);\r\n      if (cache) {\r\n        reRenderShape = [...reRenderShape, ...cache.list];\r\n      }\r\n    });\r\n\r\n    console.log('clearArea', shape.coverArea);\r\n    reRenderShape = [...new Set([...reRenderShape])];\r\n    console.log('reRenderShape', reRenderShape);\r\n    // 擦除\r\n    this.clearGrid(shape.coverArea);\r\n    // 重绘\r\n    this.reRender(reRenderShape, shape);\r\n  };\r\n\r\n  // 局部擦除\r\n  private clearGrid(area: CoverArea): void {\r\n    this.getCtx().clearRect(area.x, area.y, area.width, area.height);\r\n  }\r\n\r\n  // 局部重绘\r\n  private reRender(list: string[], targetShape: Shape): void {\r\n    // targetShape最后render\r\n    // 按zindex顺序绘制\r\n    const shapeList = list.map((id) => this.meshLayer.shapeBucket.get(id));\r\n    shapeList.sort((a, b) => b.zIndex - a.zIndex);\r\n    // console.log('shapeList', shapeList);\r\n    const ctx = this.getCtx();\r\n    shapeList.forEach((shape) => {\r\n      shape.render(ctx);\r\n    });\r\n\r\n    // 最后绘制\r\n    targetShape.render(ctx);\r\n  }\r\n\r\n  // 销毁（其实不用调用）\r\n  public destroy() {\r\n    // 取消监听器\r\n    this.interactionHandler.destroy();\r\n    // 解除eventBus\r\n    this.unbindEvent();\r\n  }\r\n\r\n  public getCtx(): CanvasRenderingContext2D {\r\n    return this.displayLayer.ctx;\r\n  }\r\n\r\n  // 生成count个随机shape\r\n  public generateShape(count: number): Shape[] {\r\n    const list = [];\r\n\r\n    while (count) {\r\n      const shape = new Shape({\r\n        x: Math.floor(Math.random() * this.width),\r\n        y: Math.floor(Math.random() * this.height),\r\n        radius: Math.floor(Math.random() * 10 + 30), // 30 ~ 40\r\n        zIndex: count,\r\n      });\r\n      list.push(shape);\r\n\r\n      count--;\r\n    }\r\n\r\n    return list;\r\n  }\r\n}\r\n","/*\r\n * @Author: yorshka\r\n * @Date: 2021-01-29 22:19:49\r\n * @Last Modified by: yorshka\r\n * @Last Modified time: 2021-01-30 21:16:48\r\n *\r\n * demo: 数百个圆，随机排布，可被鼠标点击。点击后变色并置于顶层，其他圆的绘制顺序不变。\r\n */\r\n\r\nimport { Demo } from './demo';\r\n\r\n// 新建demo实例\r\nconst demo = new Demo({\r\n  container: 'container',\r\n});\r\n\r\nwindow.demo = demo;\r\n\r\n// 生成图形\r\nconst shapeList = demo.generateShape(120);\r\n\r\n// 渲染图像\r\nconst ctx = demo.getCtx();\r\nshapeList.forEach((shape) => {\r\n  shape.render(ctx);\r\n});\r\n\r\n// 退出时销毁实例\r\nwindow.onunload = () => {\r\n  demo.destroy();\r\n};\r\n"],"names":["EventBus","global","freeGlobal","root","trimmedEndIndex","objectProto","nativeObjectToString","symToStringTag","Symbol","getRawTag","objectToString","isObjectLike","baseGetTag","isSymbol","isObject","baseTrim","FUNC_ERROR_TEXT","toNumber","now","debounce","throttle"],"mappings":";;AAAA;;;;;;;AAOG;AAIW,MAAO,MAAM,CAAA;;AAEf,IAAA,SAAS,CAAqB;;AAEjC,IAAA,SAAS,CAA2B;;AAEpC,IAAA,GAAG,CAAkC;;AAGlC,IAAA,KAAK,CAAS;AACd,IAAA,MAAM,CAAS;AAEzB,IAAA,WAAA,CAAY,OAAsB,EAAA;QAChC,MAAM,EAAE,SAAS,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,OAAO,CAAC;;AAGhD,QAAA,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;;QAG3B,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AAChD,QAAA,MAAM,CAAC,KAAK,GAAG,SAAS,CAAC,WAAW,CAAC;AACrC,QAAA,MAAM,CAAC,MAAM,GAAG,SAAS,CAAC,YAAY,CAAC;AAEvC,QAAA,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC,WAAW,CAAC;AACnC,QAAA,IAAI,CAAC,MAAM,GAAG,SAAS,CAAC,YAAY,CAAC;;AAGrC,QAAA,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;;AAG9B,QAAA,MAAM,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC;AACnC,QAAA,MAAM,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC;AACvB,QAAA,MAAM,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,CAAC;;QAGxB,MAAM,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,GAAG,EAAE,CAAC;;AAGlC,QAAA,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC;QACxB,IAAI,CAAC,GAAG,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;;AAGnC,QAAA,IAAI,CAAC,GAAG,CAAC,wBAAwB,GAAG,aAAa,CAAC;;AAGlD,QAAA,IAAI,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,CAAC;AACvB,QAAA,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,MAAM,CAAC;;QAG9B,IAAI,CAAC,IAAI,EAAE;AACT,YAAA,IAAI,CAAC,SAAU,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;AACrC,SAAA;KACF;AACF;;AChED;AACO,MAAM,QAAQ,GAAG,EAAE,CAAC;AAc3B;AACO,MAAM,SAAS,GAAG,CAAC,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,CAAC;;AChBrE;;;;;;;;AAQG;AAiBW,MAAO,QAAQ,CAAA;IACnB,OAAO,SAAS,CAAW;AAEnC,IAAA,WAAW,QAAQ,GAAA;AACjB,QAAA,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;AACnB,YAAA,IAAI,CAAC,SAAS,GAAG,IAAI,QAAQ,EAAE,CAAC;AACjC,SAAA;QAED,OAAO,IAAI,CAAC,SAAS,CAAC;KACvB;AAEO,IAAA,gBAAgB,CAAS;AAEzB,IAAA,cAAc,CAAyB;AAE/C,IAAA,WAAA,GAAA;QACE,IAAI,QAAQ,CAAC,SAAS,EAAE;YACtB,OAAO,QAAQ,CAAC,SAAS,CAAC;AAC3B,SAAA;AAED,QAAA,IAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC;AAClC,QAAA,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,EAAqB,CAAC;AAEnD,QAAA,QAAQ,CAAC,SAAS,GAAG,IAAI,CAAC;KAC3B;IAEM,KAAK,GAAA;AACV,QAAA,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;AAE3B,QAAA,QAAQ,CAAC,SAAS,GAAG,IAAI,CAAC;KAC3B;AAEM,IAAA,SAAS,CAAC,SAAiB,EAAA;QAChC,MAAM,IAAI,GAAG,SAAS,IAAI,IAAI,CAAC,gBAAgB,CAAC;QAEhD,IAAI,IAAI,CAAC,cAAc,EAAE,GAAG,CAAC,IAAI,CAAC,EAAE;YAClC,OAAO,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACtC,SAAA;AAED,QAAA,MAAM,SAAS,GAAc;AAC3B,YAAA,EAAE,EAAE,CAAC,GAAW,EAAE,EAAgB,KAAI;gBACpC,IAAI,CAAC,EAAE,CAAC,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;aACxB;AACD,YAAA,MAAM,EAAE,CAAC,GAAW,EAAE,EAAgB,KAAI;gBACxC,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;aAC5B;YACD,IAAI,CAAC,GAAG,IAAS,EAAA;AACf,gBAAA,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,GAAG,IAAI,CAAC;gBAC7B,MAAM,aAAa,GAAG,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,CAAC;gBAChD,IAAI,aAAa,EAAE,MAAM,EAAE;AACzB,oBAAA,aAAa,CAAC,OAAO,CAAC,CAAC,OAAqB,KAAI;wBAC9C,OAAO,CAAC,MAAM,CAAC,CAAC;AAClB,qBAAC,CAAC,CAAC;AACJ,iBAAA;aACF;YACD,WAAW,EAAE,EAAE;SAChB,CAAC;QAEF,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;AAEzC,QAAA,OAAO,SAAS,CAAC;KAClB;;AAGO,IAAA,EAAE,GAAG,UAAU,IAAY,EAAE,GAAW,EAAE,EAAgB,EAAA;QAChE,MAAM,SAAS,GAAG,IAAI,CAAC,cAAc,EAAE,GAAG,CAAC,IAAI,CAAC,CAAC;QACjD,IAAI,CAAC,SAAS,EAAE;YACd,OAAO;AACR,SAAA;AAED,QAAA,MAAM,KAAK,GAAG,SAAS,CAAC,WAAW,CAAC;AACpC,QAAA,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE;AACf,YAAA,KAAK,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;AACjB,SAAA;QACD,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AACtB,KAAC,CAAC;;AAGM,IAAA,MAAM,GAAG,UACf,IAAY,EACZ,GAAW,EACX,EAAiB,EAAA;QAEjB,MAAM,SAAS,GAAG,IAAI,CAAC,cAAc,EAAE,GAAG,CAAC,IAAI,CAAC,CAAC;QACjD,IAAI,CAAC,SAAS,EAAE;YACd,OAAO;AACR,SAAA;AAED,QAAA,MAAM,KAAK,GAAG,SAAS,CAAC,WAAW,CAAC;AACpC,QAAA,IAAI,KAAK,CAAC,GAAG,CAAC,EAAE;AACd,YAAA,IAAI,EAAE,EAAE;AACN,gBAAA,KAAK,IAAI,CAAC,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;oBAC3C,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,EAAE;wBACxB,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACzB,qBAAA;AACF,iBAAA;AACF,aAAA;AAAM,iBAAA;AACL,gBAAA,KAAK,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;AACjB,aAAA;AACF,SAAA;AACH,KAAC,CAAC;AACH;;AC9HD;;AAEG;AACH,IAAY,UAQX,CAAA;AARD,CAAA,UAAY,UAAU,EAAA;AACpB,IAAA,UAAA,CAAA,MAAA,CAAA,GAAA,MAAa,CAAA;AACb,IAAA,UAAA,CAAA,WAAA,CAAA,GAAA,WAAuB,CAAA;AAEvB,IAAA,UAAA,CAAA,OAAA,CAAA,GAAA,OAAe,CAAA;AACf,IAAA,UAAA,CAAA,OAAA,CAAA,GAAA,OAAe,CAAA;AAEf,IAAA,UAAA,CAAA,OAAA,CAAA,GAAA,OAAe,CAAA;AACjB,CAAC,EARW,UAAU,KAAV,UAAU,GAQrB,EAAA,CAAA,CAAA,CAAA;AAED;;AAEG;AACH,IAAY,SAGX,CAAA;AAHD,CAAA,UAAY,SAAS,EAAA;AACnB,IAAA,SAAA,CAAA,aAAA,CAAA,GAAA,aAA2B,CAAA;AAC3B,IAAA,SAAA,CAAA,MAAA,CAAA,GAAA,MAAa,CAAA;AACf,CAAC,EAHW,SAAS,KAAT,SAAS,GAGpB,EAAA,CAAA,CAAA;;AChBD,MAAM,GAAG,GAAG,IAAI,QAAQ,EAAE;;ACH1B;;;;;AAKG;AAeH;MACa,WAAW,CAAA;AACtB,IAAA,CAAC,CAAS;AACV,IAAA,CAAC,CAAS;AACV,IAAA,KAAK,CAAS;AACd,IAAA,MAAM,CAAS;AAEf,IAAA,WAAA,CAAY,IAAqB,EAAA;QAC/B,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC;AACrC,QAAA,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;AACX,QAAA,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;AACX,QAAA,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;AACnB,QAAA,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;KACtB;AACF;;AClCD;;;;;AAKG;AAKH;AACM,SAAU,kBAAkB,CAAC,KAAY,EAAA;IAC7C,OAAO,IAAI,WAAW,CAAC;AACrB,QAAA,CAAC,EAAE,KAAK,CAAC,CAAC,GAAG,KAAK,CAAC,MAAM;AACzB,QAAA,CAAC,EAAE,KAAK,CAAC,CAAC,GAAG,KAAK,CAAC,MAAM;AACzB,QAAA,KAAK,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM;AACvB,QAAA,MAAM,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM;AACzB,KAAA,CAAC,CAAC;AACL,CAAC;AAED;AACM,SAAU,WAAW,CACzB,EAAU,EACV,EAAU,EACV,EAAU,EACV,EAAU,EAAA;IAEV,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;AAChE;;AC5BA;;;;;;;AAOG;AAYkB,MAAA,SAAU,SAAQ,MAAM,CAAA;IACnC,OAAO,CAAQ;AAEvB,IAAA,IAAY,WAAW,GAAA;QACrB,OAAO,IAAI,CAAC,OAAO,CAAC;KACrB;IAED,IAAY,WAAW,CAAC,GAAU,EAAA;QAChC,IAAI,CAAC,GAAG,EAAE;YACR,IAAI,CAAC,KAAK,EAAE,CAAC;YACb,OAAO;AACR,SAAA;AAED,QAAA,IAAI,GAAG,CAAC,EAAE,KAAK,IAAI,CAAC,OAAO,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;AAChD,YAAA,IAAI,CAAC,OAAO,GAAG,GAAG,CAAC;YACnB,IAAI,CAAC,KAAK,EAAE,CAAC;AACb,YAAA,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;AACzB,SAAA;KACF;AAED,IAAA,WAAA,CAAY,OAAyB,EAAA;QACnC,KAAK,CAAC,OAAO,CAAC,CAAC;;AAGf,QAAA,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,SAAS,CAAC;AAEjC,QAAA,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;;QAGpB,IAAI,CAAC,IAAI,EAAE,CAAC;KACb;IAEM,OAAO,GAAA;QACZ,IAAI,CAAC,MAAM,EAAE,CAAC;KACf;IAEO,IAAI,GAAA;AACV,QAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,EAAE,CAC1C,UAAU,CAAC,KAAK,EAChB,IAAI,CAAC,YAAY,CAClB,CAAC;KACH;IAEO,MAAM,GAAA;AACZ,QAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;KACpE;AAEO,IAAA,YAAY,GAAG,CAAC,KAAY,KAAI;AACtC,QAAA,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;AAC3B,KAAC,CAAC;;AAGM,IAAA,aAAa,CAAC,KAAY,EAAA;AAChC,QAAA,MAAM,IAAI,GAAG,kBAAkB,CAAC,KAAK,CAAC,CAAC;QAEvC,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;KAC9D;IAEO,KAAK,GAAA;AACX,QAAA,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;KACnD;AACF;;AChFD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,QAAQ,CAAC,KAAK,EAAE;AACzB,EAAE,IAAI,IAAI,GAAG,OAAO,KAAK,CAAC;AAC1B,EAAE,OAAO,KAAK,IAAI,IAAI,KAAK,IAAI,IAAI,QAAQ,IAAI,IAAI,IAAI,UAAU,CAAC,CAAC;AACnE,CAAC;AACD;AACA,IAAA,UAAc,GAAG,QAAQ;;;;AC9BzB;AACA,IAAI,UAAU,GAAG,OAAOC,cAAM,IAAI,QAAQ,IAAIA,cAAM,IAAIA,cAAM,CAAC,MAAM,KAAK,MAAM,IAAIA,cAAM,CAAC;AAC3F;AACA,IAAA,WAAc,GAAG,UAAU;;ACD3B;AACA,IAAI,QAAQ,GAAG,OAAO,IAAI,IAAI,QAAQ,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,KAAK,MAAM,IAAI,IAAI,CAAC;AACjF;AACA;AACA,IAAI,IAAI,GAAGC,WAAU,IAAI,QAAQ,IAAI,QAAQ,CAAC,aAAa,CAAC,EAAE,CAAC;AAC/D;AACA,IAAA,KAAc,GAAG,IAAI;;ACNrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,GAAG,GAAG,WAAW;AACrB,EAAE,OAAOC,KAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;AACzB,CAAC,CAAC;AACF;AACA,IAAA,KAAc,GAAG,GAAG;;ACtBpB;AACA,IAAI,YAAY,GAAG,IAAI,CAAC;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,eAAe,CAAC,MAAM,EAAE;AACjC,EAAE,IAAI,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC;AAC5B;AACA,EAAE,OAAO,KAAK,EAAE,IAAI,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE;AAC/D,EAAE,OAAO,KAAK,CAAC;AACf,CAAC;AACD;AACA,IAAA,gBAAc,GAAG,eAAe;;AChBhC;AACA,IAAI,WAAW,GAAG,MAAM,CAAC;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,QAAQ,CAAC,MAAM,EAAE;AAC1B,EAAE,OAAO,MAAM;AACf,MAAM,MAAM,CAAC,KAAK,CAAC,CAAC,EAAEC,gBAAe,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,EAAE,CAAC;AAC3E,MAAM,MAAM,CAAC;AACb,CAAC;AACD;AACA,IAAA,SAAc,GAAG,QAAQ;;AChBzB;AACA,IAAI,MAAM,GAAGD,KAAI,CAAC,MAAM,CAAC;AACzB;AACA,IAAA,OAAc,GAAG,MAAM;;ACHvB;AACA,IAAIE,aAAW,GAAG,MAAM,CAAC,SAAS,CAAC;AACnC;AACA;AACA,IAAI,cAAc,GAAGA,aAAW,CAAC,cAAc,CAAC;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,IAAIC,sBAAoB,GAAGD,aAAW,CAAC,QAAQ,CAAC;AAChD;AACA;AACA,IAAIE,gBAAc,GAAGC,OAAM,GAAGA,OAAM,CAAC,WAAW,GAAG,SAAS,CAAC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,SAAS,CAAC,KAAK,EAAE;AAC1B,EAAE,IAAI,KAAK,GAAG,cAAc,CAAC,IAAI,CAAC,KAAK,EAAED,gBAAc,CAAC;AACxD,MAAM,GAAG,GAAG,KAAK,CAACA,gBAAc,CAAC,CAAC;AAClC;AACA,EAAE,IAAI;AACN,IAAI,KAAK,CAACA,gBAAc,CAAC,GAAG,SAAS,CAAC;AACtC,IAAI,IAAI,QAAQ,GAAG,IAAI,CAAC;AACxB,GAAG,CAAC,OAAO,CAAC,EAAE,EAAE;AAChB;AACA,EAAE,IAAI,MAAM,GAAGD,sBAAoB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AAChD,EAAE,IAAI,QAAQ,EAAE;AAChB,IAAI,IAAI,KAAK,EAAE;AACf,MAAM,KAAK,CAACC,gBAAc,CAAC,GAAG,GAAG,CAAC;AAClC,KAAK,MAAM;AACX,MAAM,OAAO,KAAK,CAACA,gBAAc,CAAC,CAAC;AACnC,KAAK;AACL,GAAG;AACH,EAAE,OAAO,MAAM,CAAC;AAChB,CAAC;AACD;AACA,IAAA,UAAc,GAAG,SAAS;;AC7C1B;AACA,IAAI,WAAW,GAAG,MAAM,CAAC,SAAS,CAAC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,oBAAoB,GAAG,WAAW,CAAC,QAAQ,CAAC;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,cAAc,CAAC,KAAK,EAAE;AAC/B,EAAE,OAAO,oBAAoB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AAC1C,CAAC;AACD;AACA,IAAA,eAAc,GAAG,cAAc;;ACjB/B;AACA,IAAI,OAAO,GAAG,eAAe;AAC7B,IAAI,YAAY,GAAG,oBAAoB,CAAC;AACxC;AACA;AACA,IAAI,cAAc,GAAGC,OAAM,GAAGA,OAAM,CAAC,WAAW,GAAG,SAAS,CAAC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,UAAU,CAAC,KAAK,EAAE;AAC3B,EAAE,IAAI,KAAK,IAAI,IAAI,EAAE;AACrB,IAAI,OAAO,KAAK,KAAK,SAAS,GAAG,YAAY,GAAG,OAAO,CAAC;AACxD,GAAG;AACH,EAAE,OAAO,CAAC,cAAc,IAAI,cAAc,IAAI,MAAM,CAAC,KAAK,CAAC;AAC3D,MAAMC,UAAS,CAAC,KAAK,CAAC;AACtB,MAAMC,eAAc,CAAC,KAAK,CAAC,CAAC;AAC5B,CAAC;AACD;AACA,IAAA,WAAc,GAAG,UAAU;;AC3B3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,YAAY,CAAC,KAAK,EAAE;AAC7B,EAAE,OAAO,KAAK,IAAI,IAAI,IAAI,OAAO,KAAK,IAAI,QAAQ,CAAC;AACnD,CAAC;AACD;AACA,IAAA,cAAc,GAAG,YAAY;;ACzB7B;AACA,IAAI,SAAS,GAAG,iBAAiB,CAAC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,QAAQ,CAAC,KAAK,EAAE;AACzB,EAAE,OAAO,OAAO,KAAK,IAAI,QAAQ;AACjC,KAAKC,cAAY,CAAC,KAAK,CAAC,IAAIC,WAAU,CAAC,KAAK,CAAC,IAAI,SAAS,CAAC,CAAC;AAC5D,CAAC;AACD;AACA,IAAA,UAAc,GAAG,QAAQ;;ACxBzB;AACA,IAAI,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC;AAChB;AACA;AACA,IAAI,UAAU,GAAG,oBAAoB,CAAC;AACtC;AACA;AACA,IAAI,UAAU,GAAG,YAAY,CAAC;AAC9B;AACA;AACA,IAAI,SAAS,GAAG,aAAa,CAAC;AAC9B;AACA;AACA,IAAI,YAAY,GAAG,QAAQ,CAAC;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,QAAQ,CAAC,KAAK,EAAE;AACzB,EAAE,IAAI,OAAO,KAAK,IAAI,QAAQ,EAAE;AAChC,IAAI,OAAO,KAAK,CAAC;AACjB,GAAG;AACH,EAAE,IAAIC,UAAQ,CAAC,KAAK,CAAC,EAAE;AACvB,IAAI,OAAO,GAAG,CAAC;AACf,GAAG;AACH,EAAE,IAAIC,UAAQ,CAAC,KAAK,CAAC,EAAE;AACvB,IAAI,IAAI,KAAK,GAAG,OAAO,KAAK,CAAC,OAAO,IAAI,UAAU,GAAG,KAAK,CAAC,OAAO,EAAE,GAAG,KAAK,CAAC;AAC7E,IAAI,KAAK,GAAGA,UAAQ,CAAC,KAAK,CAAC,IAAI,KAAK,GAAG,EAAE,IAAI,KAAK,CAAC;AACnD,GAAG;AACH,EAAE,IAAI,OAAO,KAAK,IAAI,QAAQ,EAAE;AAChC,IAAI,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,GAAG,CAAC,KAAK,CAAC;AACxC,GAAG;AACH,EAAE,KAAK,GAAGC,SAAQ,CAAC,KAAK,CAAC,CAAC;AAC1B,EAAE,IAAI,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AACxC,EAAE,OAAO,CAAC,QAAQ,IAAI,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC;AAC3C,MAAM,YAAY,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,QAAQ,GAAG,CAAC,GAAG,CAAC,CAAC;AACpD,OAAO,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC;AAC9C,CAAC;AACD;AACA,IAAA,UAAc,GAAG,QAAQ;;AC3DzB;AACA,IAAIC,iBAAe,GAAG,qBAAqB,CAAC;AAC5C;AACA;AACA,IAAI,SAAS,GAAG,IAAI,CAAC,GAAG;AACxB,IAAI,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE;AACvC,EAAE,IAAI,QAAQ;AACd,MAAM,QAAQ;AACd,MAAM,OAAO;AACb,MAAM,MAAM;AACZ,MAAM,OAAO;AACb,MAAM,YAAY;AAClB,MAAM,cAAc,GAAG,CAAC;AACxB,MAAM,OAAO,GAAG,KAAK;AACrB,MAAM,MAAM,GAAG,KAAK;AACpB,MAAM,QAAQ,GAAG,IAAI,CAAC;AACtB;AACA,EAAE,IAAI,OAAO,IAAI,IAAI,UAAU,EAAE;AACjC,IAAI,MAAM,IAAI,SAAS,CAACA,iBAAe,CAAC,CAAC;AACzC,GAAG;AACH,EAAE,IAAI,GAAGC,UAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC7B,EAAE,IAAIH,UAAQ,CAAC,OAAO,CAAC,EAAE;AACzB,IAAI,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC;AAChC,IAAI,MAAM,GAAG,SAAS,IAAI,OAAO,CAAC;AAClC,IAAI,OAAO,GAAG,MAAM,GAAG,SAAS,CAACG,UAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,GAAG,OAAO,CAAC;AACjF,IAAI,QAAQ,GAAG,UAAU,IAAI,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC,QAAQ,GAAG,QAAQ,CAAC;AACrE,GAAG;AACH;AACA,EAAE,SAAS,UAAU,CAAC,IAAI,EAAE;AAC5B,IAAI,IAAI,IAAI,GAAG,QAAQ;AACvB,QAAQ,OAAO,GAAG,QAAQ,CAAC;AAC3B;AACA,IAAI,QAAQ,GAAG,QAAQ,GAAG,SAAS,CAAC;AACpC,IAAI,cAAc,GAAG,IAAI,CAAC;AAC1B,IAAI,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;AACvC,IAAI,OAAO,MAAM,CAAC;AAClB,GAAG;AACH;AACA,EAAE,SAAS,WAAW,CAAC,IAAI,EAAE;AAC7B;AACA,IAAI,cAAc,GAAG,IAAI,CAAC;AAC1B;AACA,IAAI,OAAO,GAAG,UAAU,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;AAC7C;AACA,IAAI,OAAO,OAAO,GAAG,UAAU,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;AAC/C,GAAG;AACH;AACA,EAAE,SAAS,aAAa,CAAC,IAAI,EAAE;AAC/B,IAAI,IAAI,iBAAiB,GAAG,IAAI,GAAG,YAAY;AAC/C,QAAQ,mBAAmB,GAAG,IAAI,GAAG,cAAc;AACnD,QAAQ,WAAW,GAAG,IAAI,GAAG,iBAAiB,CAAC;AAC/C;AACA,IAAI,OAAO,MAAM;AACjB,QAAQ,SAAS,CAAC,WAAW,EAAE,OAAO,GAAG,mBAAmB,CAAC;AAC7D,QAAQ,WAAW,CAAC;AACpB,GAAG;AACH;AACA,EAAE,SAAS,YAAY,CAAC,IAAI,EAAE;AAC9B,IAAI,IAAI,iBAAiB,GAAG,IAAI,GAAG,YAAY;AAC/C,QAAQ,mBAAmB,GAAG,IAAI,GAAG,cAAc,CAAC;AACpD;AACA;AACA;AACA;AACA,IAAI,QAAQ,YAAY,KAAK,SAAS,KAAK,iBAAiB,IAAI,IAAI,CAAC;AACrE,OAAO,iBAAiB,GAAG,CAAC,CAAC,KAAK,MAAM,IAAI,mBAAmB,IAAI,OAAO,CAAC,EAAE;AAC7E,GAAG;AACH;AACA,EAAE,SAAS,YAAY,GAAG;AAC1B,IAAI,IAAI,IAAI,GAAGC,KAAG,EAAE,CAAC;AACrB,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,EAAE;AAC5B,MAAM,OAAO,YAAY,CAAC,IAAI,CAAC,CAAC;AAChC,KAAK;AACL;AACA,IAAI,OAAO,GAAG,UAAU,CAAC,YAAY,EAAE,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC;AAC5D,GAAG;AACH;AACA,EAAE,SAAS,YAAY,CAAC,IAAI,EAAE;AAC9B,IAAI,OAAO,GAAG,SAAS,CAAC;AACxB;AACA;AACA;AACA,IAAI,IAAI,QAAQ,IAAI,QAAQ,EAAE;AAC9B,MAAM,OAAO,UAAU,CAAC,IAAI,CAAC,CAAC;AAC9B,KAAK;AACL,IAAI,QAAQ,GAAG,QAAQ,GAAG,SAAS,CAAC;AACpC,IAAI,OAAO,MAAM,CAAC;AAClB,GAAG;AACH;AACA,EAAE,SAAS,MAAM,GAAG;AACpB,IAAI,IAAI,OAAO,KAAK,SAAS,EAAE;AAC/B,MAAM,YAAY,CAAC,OAAO,CAAC,CAAC;AAC5B,KAAK;AACL,IAAI,cAAc,GAAG,CAAC,CAAC;AACvB,IAAI,QAAQ,GAAG,YAAY,GAAG,QAAQ,GAAG,OAAO,GAAG,SAAS,CAAC;AAC7D,GAAG;AACH;AACA,EAAE,SAAS,KAAK,GAAG;AACnB,IAAI,OAAO,OAAO,KAAK,SAAS,GAAG,MAAM,GAAG,YAAY,CAACA,KAAG,EAAE,CAAC,CAAC;AAChE,GAAG;AACH;AACA,EAAE,SAAS,SAAS,GAAG;AACvB,IAAI,IAAI,IAAI,GAAGA,KAAG,EAAE;AACpB,QAAQ,UAAU,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;AACxC;AACA,IAAI,QAAQ,GAAG,SAAS,CAAC;AACzB,IAAI,QAAQ,GAAG,IAAI,CAAC;AACpB,IAAI,YAAY,GAAG,IAAI,CAAC;AACxB;AACA,IAAI,IAAI,UAAU,EAAE;AACpB,MAAM,IAAI,OAAO,KAAK,SAAS,EAAE;AACjC,QAAQ,OAAO,WAAW,CAAC,YAAY,CAAC,CAAC;AACzC,OAAO;AACP,MAAM,IAAI,MAAM,EAAE;AAClB;AACA,QAAQ,YAAY,CAAC,OAAO,CAAC,CAAC;AAC9B,QAAQ,OAAO,GAAG,UAAU,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;AACjD,QAAQ,OAAO,UAAU,CAAC,YAAY,CAAC,CAAC;AACxC,OAAO;AACP,KAAK;AACL,IAAI,IAAI,OAAO,KAAK,SAAS,EAAE;AAC/B,MAAM,OAAO,GAAG,UAAU,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;AAC/C,KAAK;AACL,IAAI,OAAO,MAAM,CAAC;AAClB,GAAG;AACH,EAAE,SAAS,CAAC,MAAM,GAAG,MAAM,CAAC;AAC5B,EAAE,SAAS,CAAC,KAAK,GAAG,KAAK,CAAC;AAC1B,EAAE,OAAO,SAAS,CAAC;AACnB,CAAC;AACD;AACA,IAAA,UAAc,GAAG,QAAQ;;AC3LzB;AACA,IAAI,eAAe,GAAG,qBAAqB,CAAC;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE;AACvC,EAAE,IAAI,OAAO,GAAG,IAAI;AACpB,MAAM,QAAQ,GAAG,IAAI,CAAC;AACtB;AACA,EAAE,IAAI,OAAO,IAAI,IAAI,UAAU,EAAE;AACjC,IAAI,MAAM,IAAI,SAAS,CAAC,eAAe,CAAC,CAAC;AACzC,GAAG;AACH,EAAE,IAAIJ,UAAQ,CAAC,OAAO,CAAC,EAAE;AACzB,IAAI,OAAO,GAAG,SAAS,IAAI,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC,OAAO,GAAG,OAAO,CAAC;AACjE,IAAI,QAAQ,GAAG,UAAU,IAAI,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC,QAAQ,GAAG,QAAQ,CAAC;AACrE,GAAG;AACH,EAAE,OAAOK,UAAQ,CAAC,IAAI,EAAE,IAAI,EAAE;AAC9B,IAAI,SAAS,EAAE,OAAO;AACtB,IAAI,SAAS,EAAE,IAAI;AACnB,IAAI,UAAU,EAAE,QAAQ;AACxB,GAAG,CAAC,CAAC;AACL,CAAC;AACD;AACA,IAAA,UAAc,GAAG,QAAQ;;ACpEzB;;;;;;;AAOG;AAWW,MAAO,WAAW,CAAA;;AAEtB,IAAA,MAAM,CAAoB;AAElC,IAAA,WAAA,CAAY,OAA2B,EAAA;QACrC,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC;QAEvC,IAAI,CAAC,IAAI,EAAE,CAAC;KACb;;IAGM,OAAO,GAAA;QACZ,IAAI,CAAC,MAAM,CAAC,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;QACpE,IAAI,CAAC,MAAM,CAAC,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;KACrE;;IAGM,IAAI,GAAA;QACT,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;QACjE,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;KAClE;IAEO,gBAAgB,GAAG,CAAC,CAAa,KACvCC,UAAQ,CAAC,CAAC,CAAa,KAAI;AACzB,QAAA,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,CAAC,CAAC;;AAE/B,QAAApB,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE;AAC9D,YAAA,CAAC,EAAE,OAAO;AACV,YAAA,CAAC,EAAE,OAAO;AACX,SAAA,CAAC,CAAC;AACL,KAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;AAEJ,IAAA,gBAAgB,GAAG,CAAC,CAAa,KAAI;AAC3C,QAAA,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,CAAC,CAAC;;AAE/B,QAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE;AACnE,YAAA,CAAC,EAAE,OAAO;AACV,YAAA,CAAC,EAAE,OAAO;AACX,SAAA,CAAC,CAAC;AACL,KAAC,CAAC;AACH;;AC1DD;;;;;AAKG;AAIH;AACM,SAAU,cAAc,CAC5B,CAAS,EACT,CAAS,EACT,MAAc,EACd,QAAgB,EAAA;IAEhB,MAAM,IAAI,GAAG,EAAE,CAAC;;AAGhB,IAAA,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,MAAM,EAAE,CAAC,GAAG,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,CAAC;IAC9E,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,MAAM,EAAE,CAAC,GAAG,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,CAAC;IACzD,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,MAAM,EAAE,CAAC,GAAG,MAAM,CAAC,CAAC;;;IAKzD,MAAM,KAAK,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC;IAC3E,MAAM,KAAK,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC;;AAI3E,IAAA,KAAK,IAAI,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;AACzC,QAAA,KAAK,IAAI,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,CAAC,IAAI,CAAC,CAAA,EAAG,CAAC,CAAI,CAAA,EAAA,CAAC,CAAE,CAAA,CAAC,CAAC;AACxB,SAAA;AACF,KAAA;;AAID,IAAA,OAAO,IAAI,CAAC;AACd,CAAC;AAED;SACgB,WAAW,CAAC,CAAS,EAAE,CAAS,EAAE,QAAgB,EAAA;IAChE,MAAM,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC;IACpC,MAAM,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC;AAEpC,IAAA,OAAO,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;AAClB,CAAC;AAED;AACM,SAAU,YAAY,CAC1B,CAAS,EACT,CAAS,EACT,MAAc,EACd,QAAgB,EAAA;AAEhB,IAAA,MAAM,IAAI,GAAc;AACtB,QAAA,CAAC,EAAE,CAAC;AACJ,QAAA,CAAC,EAAE,CAAC;AACJ,QAAA,KAAK,EAAE,CAAC;AACR,QAAA,MAAM,EAAE,CAAC;KACV,CAAC;;AAGF,IAAA,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,MAAM,EAAE,CAAC,GAAG,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,CAAC;IAC9E,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,MAAM,EAAE,CAAC,GAAG,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,CAAC;IACzD,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,MAAM,EAAE,CAAC,GAAG,MAAM,CAAC,CAAC;IAEzD,MAAM,KAAK,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC;IAC3E,MAAM,KAAK,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC;IAE3E,IAAI,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC;IAC7B,IAAI,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC;AAC7B,IAAA,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,QAAQ,GAAG,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAC;AACrD,IAAA,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,QAAQ,GAAG,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAC;AAEtD,IAAA,OAAO,IAAI,CAAC;AACd;;AC9EA;;;;;;;AAOG;AAUkB,MAAA,IAAK,SAAQ,MAAM,CAAA;IACtC,OAAO,QAAQ,CAAO;;AAGtB,IAAA,WAAW,CAAqB;;AAGhC,IAAA,SAAS,CAA6B;;AAGtC,IAAA,QAAQ,CAAS;AAEjB,IAAA,WAAA,CAAY,OAAoB,EAAA;QAC9B,KAAK,CAAC,OAAO,CAAC,CAAC;QAEf,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,OAAO,IAAI,CAAC,QAAQ,CAAC;AACtB,SAAA;;AAGD,QAAA,IAAI,CAAC,WAAW,GAAG,IAAI,GAAG,EAAe,CAAC;AAC1C,QAAA,IAAI,CAAC,SAAS,GAAG,IAAI,GAAG,EAAyB,CAAC;;AAGlD,QAAA,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;;QAGjC,IAAI,CAAC,YAAY,EAAE,CAAC;AAEpB,QAAA,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;KACtB;IAEM,OAAO,GAAA;AACZ,QAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;AAClE,QAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;AAC5D,QAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;KACxE;IAEO,YAAY,GAAA;;AAElB,QAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,EAAE,CACnC,UAAU,CAAC,KAAK,EAChB,IAAI,CAAC,gBAAgB,CACtB,CAAC;;AAGF,QAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,EAAE,CAC1C,UAAU,CAAC,IAAI,EACf,IAAI,CAAC,eAAe,CACrB,CAAC;;AAGF,QAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,EAAE,CAC1C,UAAU,CAAC,SAAS,EACpB,IAAI,CAAC,eAAe,CACrB,CAAC;KACH;;AAGO,IAAA,eAAe,GAAG,CAAC,KAAY,KAAI;QACzC,MAAM,IAAI,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACpE,MAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACvC,QAAA,IAAI,KAAK,EAAE;AACT,YAAA,IAAI,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE;AACvB,gBAAA,MAAM,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;AAClD,gBAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;gBACxE,OAAO;AACR,aAAA;AACF,SAAA;AAED,QAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;AACzE,KAAC,CAAC;;AAGM,IAAA,eAAe,GAAG,CAAC,KAAY,KAAI;QACzC,MAAM,IAAI,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;;QAEpE,MAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACvC,QAAA,IAAI,KAAK,EAAE;AACT,YAAA,IAAI,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE;;;gBAGvB,MAAM,SAAS,GAAG,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;AACjE,gBAAA,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC;;AAG9C,gBAAA,MAAM,GAAG,GAAG,SAAS,CAAC,MAAM,CAAC;AAC7B,gBAAA,IAAI,MAAM,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;gBAC1B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;AAC5B,oBAAA,MAAM,KAAK,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;oBAC3B,MAAM,MAAM,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;AAC/D,oBAAA,IAAI,MAAM,IAAI,KAAK,CAAC,MAAM,EAAE;wBAC1B,MAAM,GAAG,KAAK,CAAC;wBACf,MAAM;AACP,qBAAA;AACF,iBAAA;gBAED,MAAM,CAAC,MAAM,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;;gBAGxC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,IAAI,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;AAE3D,gBAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,IAAI,CAC5C,UAAU,CAAC,KAAK,EAChB,MAAM,CACP,CAAC;gBACF,OAAO;AACR,aAAA;AACF,SAAA;AACH,KAAC,CAAC;AAEM,IAAA,gBAAgB,GAAG,CAAC,KAAY,KAAI;AAC1C,QAAA,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;AAClC,QAAA,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;AAC1B,KAAC,CAAC;;AAGK,IAAA,WAAW,CAAC,KAAY,EAAA;AAC7B,QAAA,MAAM,EAAE,EAAE,EAAE,GAAG,KAAK,CAAC;;QAGrB,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;;AAGhC,QAAA,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;KAC7B;;;AAIM,IAAA,WAAW,CAAC,KAAY,EAAA;QAC7B,MAAM,EAAE,EAAE,EAAE,YAAY,EAAE,MAAM,EAAE,GAAG,KAAK,CAAC;AAC3C,QAAA,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;AAE5B,QAAA,YAAY,CAAC,OAAO,CAAC,CAAC,IAAI,KAAI;YAC5B,MAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACvC,YAAA,IAAI,KAAK,EAAE;AACT,gBAAA,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC;gBAC/C,IAAI,KAAK,CAAC,QAAQ,IAAI,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE;AACjD,oBAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;AACrD,oBAAA,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC;AAClC,iBAAA;gBAED,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;AACjC,aAAA;AACH,SAAC,CAAC,CAAC;KACJ;;;AAIO,IAAA,eAAe,CAAC,KAAY,EAAA;QAClC,MAAM,EAAE,EAAE,EAAE,YAAY,EAAE,MAAM,EAAE,GAAG,KAAK,CAAC;AAC3C,QAAA,YAAY,CAAC,OAAO,CAAC,CAAC,IAAI,KAAI;YAC5B,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YACrC,IAAI,CAAC,KAAK,EAAE;AACV,gBAAA,KAAK,GAAG;AACN,oBAAA,IAAI,EAAE,EAAE;AACR,oBAAA,QAAQ,EAAE,CAAC;iBACZ,CAAC;AACH,aAAA;AACD,YAAA,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,KAAK,CAAC;;YAE/B,IAAI,MAAM,GAAG,QAAQ,EAAE;gBACrB,QAAQ,GAAG,MAAM,CAAC;AAClB,gBAAA,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;AAClB,aAAA;AAAM,iBAAA;AACL,gBAAA,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AACf,aAAA;;AAGD,YAAA,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;AAM/C,SAAC,CAAC,CAAC;KACJ;;AAGO,IAAA,QAAQ,CAAC,IAAY,EAAA;QAC3B,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;AACrD,QAAA,IAAI,CAAC,GAAG,CAAC,SAAS,GAAG,MAAM,CAAC;QAC5B,IAAI,CAAC,GAAG,CAAC,QAAQ,CACf,CAAC,GAAG,IAAI,CAAC,QAAQ,EACjB,CAAC,GAAG,IAAI,CAAC,QAAQ,EACjB,IAAI,CAAC,QAAQ,EACb,IAAI,CAAC,QAAQ,CACd,CAAC;KACH;;IAGM,UAAU,GAAA;AACf,QAAA,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;AAErB,QAAA,GAAG,CAAC,SAAS,GAAG,GAAG,CAAC;AACpB,QAAA,GAAG,CAAC,WAAW,GAAG,SAAS,CAAC;AAE5B,QAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QAE/B,MAAM,MAAM,GAAG,CAAC,CAAC;AACjB,QAAA,MAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;QACxC,MAAM,MAAM,GAAG,CAAC,CAAC;AACjB,QAAA,MAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC;QAEzC,GAAG,CAAC,SAAS,EAAE,CAAC;;AAGhB,QAAA,KAAK,IAAI,CAAC,GAAG,MAAM,EAAE,CAAC,IAAI,IAAI,GAAG,QAAQ,EAAE,CAAC,IAAI,QAAQ,EAAE;;YAExD,GAAG,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,GAAG,QAAQ,CAAC,CAAC;YACjC,GAAG,CAAC,MAAM,CAAC,CAAC,EAAE,IAAI,GAAG,QAAQ,CAAC,CAAC;AAChC,SAAA;;AAED,QAAA,KAAK,IAAI,CAAC,GAAG,MAAM,EAAE,CAAC,IAAI,IAAI,GAAG,QAAQ,EAAE,CAAC,IAAI,QAAQ,EAAE;;YAExD,GAAG,CAAC,MAAM,CAAC,MAAM,GAAG,QAAQ,EAAE,CAAC,CAAC,CAAC;YACjC,GAAG,CAAC,MAAM,CAAC,IAAI,GAAG,QAAQ,EAAE,CAAC,CAAC,CAAC;AAChC,SAAA;QAwBD,GAAG,CAAC,SAAS,EAAE,CAAC;QAEhB,GAAG,CAAC,MAAM,EAAE,CAAC;KACd;AACF;;ACtQD;;;;;;;AAOG;AAMW,MAAO,KAAK,CAAA;;AAExB,IAAA,EAAE,CAAS;;AAGX,IAAA,CAAC,CAAS;AACV,IAAA,CAAC,CAAS;AACV,IAAA,MAAM,CAAS;;AAGf,IAAA,SAAS,CAAS;;AAGlB,IAAA,SAAS,CAAY;;AAGrB,IAAA,QAAQ,CAAS;;AAGjB,IAAA,MAAM,CAAS;;AAGf,IAAA,YAAY,CAAW;AAEvB,IAAA,WAAA,CAAY,OAAqB,EAAA;QAC/B,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,OAAO,CAAC;;AAGzC,QAAA,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;AACX,QAAA,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;AACX,QAAA,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;AACrB,QAAA,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,SAAS,GAAG;AACf,YAAA,CAAC,EAAE,CAAC;AACJ,YAAA,CAAC,EAAE,CAAC;AACJ,YAAA,KAAK,EAAE,CAAC;AACR,YAAA,MAAM,EAAE,CAAC;SACV,CAAC;AAEF,QAAA,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;;AAG3B,QAAA,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;;QAGlD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;;QAGvC,IAAI,CAAC,SAAS,EAAE,CAAC;KAClB;;;;IAKO,SAAS,GAAA;QACf,UAAU,CAAC,MAAK;YACd,MAAM,QAAQ,GAAG,cAAc,CAC7B,IAAI,CAAC,CAAC,EACN,IAAI,CAAC,CAAC,EACN,IAAI,CAAC,MAAM,EACX,IAAI,CAAC,QAAQ,CACd,CAAC;;YAGF,IAAI,CAAC,SAAS,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;AAE1E,YAAA,IAAI,CAAC,YAAY,GAAG,QAAQ,CAAC;AAC7B,YAAA,OAAO,CAAC,GAAG,CAAC,gBAAgB,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;AACpD,YAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;SACjE,EAAE,CAAC,CAAC,CAAC;KACP;AAEM,IAAA,QAAQ,CAAC,KAAa,EAAA;AAC3B,QAAA,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;KACxB;IAEM,OAAO,GAAA;AACZ,QAAA,IAAI,CAAC,MAAM,IAAI,CAAC,CAAC;KAClB;;AAGM,IAAA,MAAM,CAAC,GAA6B,EAAA;QACzC,IAAI,CAAC,GAAG,EAAE;YACR,OAAO;AACR,SAAA;;QAGD,GAAG,CAAC,SAAS,EAAE,CAAC;QAChB,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;QACrD,GAAG,CAAC,SAAS,EAAE,CAAC;QAChB,GAAG,CAAC,MAAM,EAAE,CAAC;;QAGb,GAAG,CAAC,SAAS,EAAE,CAAC;QAChB,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;AACrD,QAAA,GAAG,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;QAC/B,GAAG,CAAC,IAAI,EAAE,CAAC;QACX,GAAG,CAAC,SAAS,EAAE,CAAC;KACjB;AACF;;AChHD;;;;;AAKG;AAIG,SAAU,YAAY,CAAC,KAAa,EAAA;IACxC,MAAM,KAAK,GAAG,SAAS,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IACvC,IAAI,KAAK,IAAI,CAAC,EAAE;AACd,QAAA,IAAI,KAAK,GAAG,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE;AAChC,YAAA,OAAO,SAAS,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;AAC7B,SAAA;AACF,KAAA;AAED,IAAA,OAAO,SAAS,CAAC,CAAC,CAAC,CAAC;AACtB;;AClBA;;;;;;;;AAQG;AAYW,MAAO,IAAI,CAAA;;AAEf,IAAA,SAAS,CAAqB;AAE9B,IAAA,KAAK,CAAS;AACd,IAAA,MAAM,CAAS;;IAGf,QAAQ,GAAG,QAAQ,CAAC;;AAGpB,IAAA,kBAAkB,CAAc;;;AAIhC,IAAA,gBAAgB,CAAS;;IAEzB,UAAU,GAAW,IAAI,CAAC;;AAE1B,IAAA,YAAY,CAAS;;AAErB,IAAA,SAAS,CAAO;AAExB,IAAA,WAAA,CAAY,OAAoB,EAAA;AAC9B,QAAA,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,CAAC;QAEpC,MAAM,SAAS,GAAG,QAAQ,CAAC,cAAc,CACvC,IAAI,IAAI,WAAW,CACL,CAAC;;AAEjB,QAAA,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;AAE3B,QAAA,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC,WAAW,CAAC;AACnC,QAAA,IAAI,CAAC,MAAM,GAAG,SAAS,CAAC,YAAY,CAAC;;AAGrC,QAAA,IAAI,CAAC,gBAAgB,GAAG,IAAI,MAAM,CAAC;AACjC,YAAA,EAAE,EAAE,aAAa;YACjB,SAAS;AACT,YAAA,MAAM,EAAE,CAAC;AACV,SAAA,CAAC,CAAC;;AAGH,QAAoB;AAClB,YAAA,IAAI,CAAC,UAAU,GAAG,IAAI,SAAS,CAAC;AAC9B,gBAAA,EAAE,EAAE,OAAO;gBACX,SAAS;AACT,gBAAA,MAAM,EAAE,CAAC;AACV,aAAA,CAAC,CAAC;AACJ,SAAA;;AAGD,QAAA,IAAI,CAAC,YAAY,GAAG,IAAI,MAAM,CAAC;AAC7B,YAAA,EAAE,EAAE,MAAM;YACV,SAAS;AACT,YAAA,MAAM,EAAE,CAAC;AACV,SAAA,CAAC,CAAC;;AAGH,QAAA,IAAI,CAAC,SAAS,GAAG,IAAI,IAAI,CAAC;AACxB,YAAA,EAAE,EAAE,MAAM;YACV,SAAS;AACT,YAAA,MAAM,EAAE,CAAC;;YAET,QAAQ,EAAE,IAAI,CAAC,QAAQ;AACxB,SAAA,CAAC,CAAC;;AAGH,QAAe;AACb,YAAA,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,CAAC;AAC7B,SAAA;;AAGD,QAAA,IAAI,CAAC,kBAAkB,GAAG,IAAI,WAAW,CAAC;YACxC,MAAM,EAAE,IAAI,CAAC,gBAAgB;AAC9B,SAAA,CAAC,CAAC;QAEH,IAAI,CAAC,YAAY,EAAE,CAAC;KACrB;IAEM,YAAY,GAAA;AACjB,QAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,EAAE,CAC1C,UAAU,CAAC,KAAK,EAChB,IAAI,CAAC,YAAY,CAClB,CAAC;;;;;;;;;KASH;IAEM,WAAW,GAAA;AAChB,QAAAA,GAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;;;KAGpE;;AAGO,IAAA,YAAY,GAAG,CAAC,KAAY,KAAI;AACtC,QAAA,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;AAC5B,QAAA,MAAM,EAAE,SAAS,EAAE,YAAY,EAAE,GAAG,KAAK,CAAC;;QAE1C,KAAK,CAAC,QAAQ,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC,CAAC;;QAExC,KAAK,CAAC,OAAO,EAAE,CAAC;;;;;QAOhB,IAAI,aAAa,GAAa,EAAE,CAAC;;AAEjC,QAAA,YAAY,CAAC,OAAO,CAAC,CAAC,IAAI,KAAI;AAC5B,YAAA,MAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACjD,YAAA,IAAI,KAAK,EAAE;gBACT,aAAa,GAAG,CAAC,GAAG,aAAa,EAAE,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC;AACnD,aAAA;AACH,SAAC,CAAC,CAAC;QAEH,OAAO,CAAC,GAAG,CAAC,WAAW,EAAE,KAAK,CAAC,SAAS,CAAC,CAAC;AAC1C,QAAA,aAAa,GAAG,CAAC,GAAG,IAAI,GAAG,CAAC,CAAC,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC;AACjD,QAAA,OAAO,CAAC,GAAG,CAAC,eAAe,EAAE,aAAa,CAAC,CAAC;;AAE5C,QAAA,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;;AAEhC,QAAA,IAAI,CAAC,QAAQ,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;AACtC,KAAC,CAAC;;AAGM,IAAA,SAAS,CAAC,IAAe,EAAA;QAC/B,IAAI,CAAC,MAAM,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;KAClE;;IAGO,QAAQ,CAAC,IAAc,EAAE,WAAkB,EAAA;;;QAGjD,MAAM,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;AACvE,QAAA,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC;;AAE9C,QAAA,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;AAC1B,QAAA,SAAS,CAAC,OAAO,CAAC,CAAC,KAAK,KAAI;AAC1B,YAAA,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;AACpB,SAAC,CAAC,CAAC;;AAGH,QAAA,WAAW,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;KACzB;;IAGM,OAAO,GAAA;;AAEZ,QAAA,IAAI,CAAC,kBAAkB,CAAC,OAAO,EAAE,CAAC;;QAElC,IAAI,CAAC,WAAW,EAAE,CAAC;KACpB;IAEM,MAAM,GAAA;AACX,QAAA,OAAO,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC;KAC9B;;AAGM,IAAA,aAAa,CAAC,KAAa,EAAA;QAChC,MAAM,IAAI,GAAG,EAAE,CAAC;AAEhB,QAAA,OAAO,KAAK,EAAE;AACZ,YAAA,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC;AACtB,gBAAA,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC;AACzC,gBAAA,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC;AAC1C,gBAAA,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;AAC3C,gBAAA,MAAM,EAAE,KAAK;AACd,aAAA,CAAC,CAAC;AACH,YAAA,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AAEjB,YAAA,KAAK,EAAE,CAAC;AACT,SAAA;AAED,QAAA,OAAO,IAAI,CAAC;KACb;AACF;;AC5MD;;;;;;;AAOG;AAIH;AACA,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC;AACpB,IAAA,SAAS,EAAE,WAAW;AACvB,CAAA,CAAC,CAAC;AAEH,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC;AAEnB;AACA,MAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;AAE1C;AACA,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;AAC1B,SAAS,CAAC,OAAO,CAAC,CAAC,KAAK,KAAI;AAC1B,IAAA,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;AACpB,CAAC,CAAC,CAAC;AAEH;AACA,MAAM,CAAC,QAAQ,GAAG,MAAK;IACrB,IAAI,CAAC,OAAO,EAAE,CAAC;AACjB,CAAC"}